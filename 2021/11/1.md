## Report 1, 3/11/2021
### Screenshots:
![image](https://user-images.githubusercontent.com/84232764/140051885-ce7b92d5-e84b-4d9b-b00e-4647bd0ed262.png)
![image](https://user-images.githubusercontent.com/84232764/140051906-a3d0dca1-d126-42ac-af76-b6ac722e4467.png)
![image](https://user-images.githubusercontent.com/84232764/140051950-20da4922-3039-4f03-acbd-f959a2c072ac.png)
![image](https://user-images.githubusercontent.com/84232764/140052367-1280557f-be8f-4e46-b0dd-2407b2a9cd4f.png)
![image](https://user-images.githubusercontent.com/84232764/140052407-746ae815-8c05-40c6-909b-d9aaa3328f5a.png)
![image](https://user-images.githubusercontent.com/84232764/140052442-758f12cb-cd41-4864-b06c-e338d044e18d.png)
![image](https://user-images.githubusercontent.com/84232764/140052464-d16d4c89-3e7b-42eb-b528-265ad1c103cc.png)


### IOCs:
#### Domains:
```
youutube.com
www.youvetube.com
1redirb.com
mediadlvr.com
safejokesearch.com
```

#### URLs:
```
http://youutube.com/
https://www.youvetube.com/
http://1redirb.com/r2.php?e=qzBy2CbrFCx2iAr9Vom1yBnkzPJtyc9vk7vH43GySHeWqBV6KWCD52dNVXiJl3OFbcXfUPAHTBxNqmNQUd5JYiw8c7aawMDcZ7IAelKvWn18qid6q9tQ9fINJo74BlAnoaKOK6lmIVCsIPAkTTcl0l2ocOVRs7PHnpoxpyjd2dC5qybKqm%2Bp%2BI4POD8SEmaTVBF29AIn1G16RyLGSh0owVuMZN9ssCN76pOU6WrEzH7U%2BomX4IWfCgehM9zESyDEhWT5w%2FbkBAmhnG1A5PdUA%2Fsrq4n97qPA82Z%2BW%2F7K4Nmp%2B%2F54KC7hlRQ1DYgfYx0l8%2B1TaV4ls7P%2BlVKjDroo%2B%2FPMdNHqFDPL5tscxfCtybAtrdeUrubx9YJ9f%2FRwTJuCkbmZjifiSY6DYJOvsv4peCVEVPjNUVhellUiAyleUoSIBhduAskRaORT%2B47ep5HIZkwZYsWc5OM8ukGv3msgRRofE25ck1FW9X5y63oW5yMS0LbSjIciySbud7fTDaE5eOpeod06Mf5YOXfi3VC2zcKQ%2Bd%2BYAA8VKNc1B%2Buz2e8%2BZRIUMGYuzVTrGTIzxgxJUMyuA3Nh2wrAh0kgpda5%2BnFU9gwMPqrTSKOtvVrF01CHPknrzhYDCp6qsJb1kjPwaV257W45pYwqzVGYt5QN26ywcjhpOkanIsDNCYNgvTh1S67iPNWnzmC4bSZrVoK9zbZ7c%2B%2BQ9xIQYn6WqB6F0WwbkwepL%2FTXlWtWhEv82%2F%2FqlrlsqfzL4bTsHZnNItcRYssjJ7UwkUj5gnJ12XUcyHWtwu16J80L
http://1redirb.com/javascript/jscheck.js
http://1redirb.com/javascript/swfobject.js
http://1redirb.com/jscheck.php?enc=QmRCUktZTkdEL2lkWWVwNjYyUk10MzQ5Zm5FMmRrMUZXVE12WTBOeFRqRXlOVEEyTmk5QmNsbGxjWEJrVGtKT1pWTlhXRWRPZDFORWNtdHllSFJCZEVrdk5raHlaMlpqU0VoTVMxZERhRkl2ZFhsNVoyVTJlVloyWVhKbVZEaGpOR3RpVVZoMVMxbHRaVk51YVhocmVrcE1VMDV4WVhKdU1FTkdjMnRQYnpObEwxWk1aVGRqZHpORU55dG9ibmR3V20xTlMyZExXbmhCSzA1b2RHVXdkRzFFVDJKS2JGTjNOMVUxWVhWTFZWZG1ZMUptZWxSMk4xcE1XbnAyT0U5WlVVSjBia3dyVms5U1dVaDBWWFIwUTNkdFRHaG5lazg1VVdwa1pYaDFOWFV3VkZoTkwydGlhSGczTDNJMWFtTjZNemRsZUVwRmFHRmpVM2RaU2pSeVozbHRlVmx4YkRjeFYzZHhhMVpEVTFGc2RHMUVWVGhYZVhwTVYwZHFaemg0VDB0bGRGaHNibVJwUVU5V2VIbGtUSGh0UkhkVlJpdFBjbkUxUWsxQloxVktRbWszWVhFNGNFUkhjbk16V0doeVpHWXJjR3M1Umk5M0wzcDRTbEJIWjJ4dE9GcHBNbWRzTDBKbFoxazBNVUZCZDJ0UFRWY3hNVVpFTDJJclMyeG1jWFJJWkVVd05qbHlVR3QzUVdOWVMybE9ZWEJOVmxGS1drTnlabTVVYUVnMGJrOXpWU3RXVm10dVkyeHFlakUxTjFCRFdHODNkM2d3WVdwdmFXUTFlRVE1TURnNWVtTmhjMGRKV1VOWFpYUkJOVlpxT0hkb2EycHlSM2RrUW1kRFNERktWMGhJWVZOdk5EQkdSSGRoU2pBNGFFWlViMDRyTVZOVFowMW9UMGRyTjBObFNXNU9kbVpzUlZkV2VEaGxjM0JMVFhGUkwyMVhUalo1ZVZNeFpYZHlXU3RHV1VWeFRYbEhSSFIzVEZWRmNrUklRM1p6WkhwNlZHNUtMMlJNU2tGbVJXUXdVREU1WkhGVFJVZEdXWGxCWWtGTFdXRlJjVTFpY0V0aGFFVlVTelp5UVdSRll6ZzNhMWgwYjFoek5sYzBhVloyUm1nd2VsZE9iMXBRZFdsbVV6aHRXakpPTWpSeVJFUXljMXB6WTFSRk5IQmpaMGxDVWswM1JFaGhUWE13ZDAxWVJpOUVUamN2VWxRck0wZENjMmd6UzJJMGJsaGpOalZ5ZEdscFFWcEdkVmszVEhGRE1Ea3haazE1V214WWJsaG5MM0ZHVlZCMk5FaHRTMUowZFRsNlZUSkRZMXBIVkU1TlVYVmtla1I1WldoNlQwOWlVVVpNU1RodU5USTBWWFJSYVdaamEycGhjM016U25Wa2IzY3pkbkZ3VVM5ME9UWkJObTQzVWk5Qkt5dHFlVmRPY2xrNFZVUXJXRzVSWTJwVGNrcExlVFYxVVc5U1ZYTk5WMXBFU1ZNeGNuZFpkbFJOYVhWek5ESndjVkp1TlZCMWEzVXhVRGhHTm5oSlZYaDNWbkUzVkhWVFdVeExTa1Z0TUZJM2R6azBjRmxwYUc1elMwdG1ZbTl2WVRoTE1uaEpOM2R5ZW5SNWFVUmg%3D&rand=0.07853355376865312
http://1redirb.com/favicon.ico
http://1redirb.com/r.php?u=https%3A%2F%2Fmediadlvr.com%2Flander.php%3Fp%3Dabove2allos%26s%3D1196829088%26sid%3D20211103221013cf98e2d5453ff40689&s=j&enc=QmRCUktZTkdEL2lkWWVwNjYyUk10MzQ5Zm5FMmRrMUZXVE12WTBOeFRqRXlOVEEyTmk5QmNsbGxjWEJrVGtKT1pWTlhXRWRPZDFORWNtdHllSFJCZEVrdk5raHlaMlpqU0VoTVMxZERhRkl2ZFhsNVoyVTJlVloyWVhKbVZEaGpOR3RpVVZoMVMxbHRaVk51YVhocmVrcE1VMDV4WVhKdU1FTkdjMnRQYnpObEwxWk1aVGRqZHpORU55dG9ibmR3V20xTlMyZExXbmhCSzA1b2RHVXdkRzFFVDJKS2JGTjNOMVUxWVhWTFZWZG1ZMUptZWxSMk4xcE1XbnAyT0U5WlVVSjBia3dyVms5U1dVaDBWWFIwUTNkdFRHaG5lazg1VVdwa1pYaDFOWFV3VkZoTkwydGlhSGczTDNJMWFtTjZNemRsZUVwRmFHRmpVM2RaU2pSeVozbHRlVmx4YkRjeFYzZHhhMVpEVTFGc2RHMUVWVGhYZVhwTVYwZHFaemg0VDB0bGRGaHNibVJwUVU5V2VIbGtUSGh0UkhkVlJpdFBjbkUxUWsxQloxVktRbWszWVhFNGNFUkhjbk16V0doeVpHWXJjR3M1Umk5M0wzcDRTbEJIWjJ4dE9GcHBNbWRzTDBKbFoxazBNVUZCZDJ0UFRWY3hNVVpFTDJJclMyeG1jWFJJWkVVd05qbHlVR3QzUVdOWVMybE9ZWEJOVmxGS1drTnlabTVVYUVnMGJrOXpWU3RXVm10dVkyeHFlakUxTjFCRFdHODNkM2d3WVdwdmFXUTFlRVE1TURnNWVtTmhjMGRKV1VOWFpYUkJOVlpxT0hkb2EycHlSM2RrUW1kRFNERktWMGhJWVZOdk5EQkdSSGRoU2pBNGFFWlViMDRyTVZOVFowMW9UMGRyTjBObFNXNU9kbVpzUlZkV2VEaGxjM0JMVFhGUkwyMVhUalo1ZVZNeFpYZHlXU3RHV1VWeFRYbEhSSFIzVEZWRmNrUklRM1p6WkhwNlZHNUtMMlJNU2tGbVJXUXdVREU1WkhGVFJVZEdXWGxCWWtGTFdXRlJjVTFpY0V0aGFFVlVTelp5UVdSRll6ZzNhMWgwYjFoek5sYzBhVloyUm1nd2VsZE9iMXBRZFdsbVV6aHRXakpPTWpSeVJFUXljMXB6WTFSRk5IQmpaMGxDVWswM1JFaGhUWE13ZDAxWVJpOUVUamN2VWxRck0wZENjMmd6UzJJMGJsaGpOalZ5ZEdscFFWcEdkVmszVEhGRE1Ea3haazE1V214WWJsaG5MM0ZHVlZCMk5FaHRTMUowZFRsNlZUSkRZMXBIVkU1TlVYVmtla1I1WldoNlQwOWlVVVpNU1RodU5USTBWWFJSYVdaamEycGhjM016U25Wa2IzY3pkbkZ3VVM5ME9UWkJObTQzVWk5Qkt5dHFlVmRPY2xrNFZVUXJXRzVSWTJwVGNrcExlVFYxVVc5U1ZYTk5WMXBFU1ZNeGNuZFpkbFJOYVhWek5ESndjVkp1TlZCMWEzVXhVRGhHTm5oSlZYaDNWbkUzVkhWVFdVeExTa1Z0TUZJM2R6azBjRmxwYUc1elMwdG1ZbTl2WVRoTE1uaEpOM2R5ZW5SNWFVUmg%3D&vs=1916:907&ds=1916:1018&sl=0:0&os=f&nos=f&swfV=0.0.0&if=f&sc=f&gpu=Google%20Inc.%20(Google)%20-%20ANGLE%20(Google,%20Vulkan%201.2.0%20(SwiftShader%20Device%20(Subzero)%20(0x0000C0DE)),%20SwiftShader%20driver-5.0.0)
https://mediadlvr.com/lander.php?p=above2allos&s=1196829088&sid=20211103221013cf98e2d5453ff40689
https://safejokesearch.com/lander?d=&utm_campaign=23a4f5fe834a2199dd59c7aa007e5815d3c0b31b
https://mediadlvr.com/favicon.ico
https://safejokesearch.com/lander-assets/22/v22.css
https://safejokesearch.com/lander-assets/14/continue.png
https://safejokesearch.com/js/lander-v2-captcha.js
https://safejokesearch.com/lander-assets/22/v22.js
https://safejokesearch.com/images/up-arrow.png
https://safejokesearch.com/images/step1.png
https://safejokesearch.com/images/step2.png
https://safejokesearch.com/images/step3.png
https://safejokesearch.com/lander-assets/14/bg2.png
https://safejokesearch.com/favicon.ico
https://safejokesearch.com/terms.html
https://safejokesearch.com/css/bootstrap.min.css
https://safejokesearch.com/css/style.css
https://safejokesearch.com/img/logo.png
https://safejokesearch.com/psrp.php?appId=122&s=redirects&t=22
https://safejokesearch.com/psrp.php?appId=122&s=step1&t=22
https://safejokesearch.com/lander/captcha-verify
https://safejokesearch.com/psrp.php?appId=122&s=step2&t=22
http://youutube.com/
https://www.youvetube.com/
http://1redirb.com/r2.php?e=qzBy2CbrFCx2iAr9Vom1yBnkzPJtyc9vcjwNE6H%2F9xVxV9XMFk6QWVdG7a1Db2%2B%2F6gSCXW7FUe5kT4OrIGTojztgL7nJEiicY9rEuLuynijdPcyYniReI4PW9iQvsBIOIWWqql9shU%2FH7NYO09MYYX79jzhexutkdew4qADl%2BOhpSyOuQYZWEXUBi%2FG3iY8fFl2%2FU%2FzuBEOk%2FiSF8VXS0sDOP4IAvAhv%2BqhQhx9q6lasrRPtsNZmi1Zhi0c4nxTn%2F3%2Bu3xv4bNSX5rLFt%2FwH%2BnscDHkQV529102lmRPcL3fU0bluQBrVJaYC6wIC7DSUOPii4HUsHkdqVtcTwlb%2FrDI2sij6ZHzNv8lmRusIDoxdJh6WFIN7dpCkec%2FVKXRXTYfnpNcYgL8RFpuuZRWP0N3h5z1tC8hFpVPhB9iynsKFImidreHi51GNjDL0kfY%2F3IcfLYtofVlfcgf6UpS8V07uxfrMONMfl3GkE85idPeC5TpD9kWJnxK4tpjuu%2BeX32oU9EpmSlsZpTUA5FNX%2F594me1%2FDXKxFHL%2F%2FZFxOI%2F9vOw8mAsS8m09SEU7AFRBr2Bys%2BAe1PDfUECUyAFrJ0weFfriikLigZwjM9dzoRbw%2BdCvqEW0EDkGuI6LQwnKahtFU%2FWg%2F4rVOODW07vwysTSKAsEVI6USeWDbokwqhhL4CDBjRJ63yKXocymjSY4tBj9jUkvxBa4wW5QsHG%2FOHGP7bvUK1HpMVoE%2BmvdTOEA05PYNgjcI73QKnEZrUbdTDvOSwmgJf5saqFVTHTdS9gvp%2FuYHCfB
http://1redirb.com/javascript/jscheck.js
http://1redirb.com/javascript/swfobject.js
http://1redirb.com/jscheck.php?enc=WW1YaXYwQ1Q4RW8rTVRxN0pqRU9iMzQ5Zml0WFRtWXJWa2MxU1UwdmN6aEVTRGR3TTFBelpscDZWek4wVnpWMFpVMVVWRGR4UW01Sk1sVlRZWFU0Y0VaSWExcDZNVFJRTXpGdlVsRlNRMFY1UW5OMWF5OXdUVFl5UW1GNWJqWnlkMHRFY1c1MFVYUTNNUzl6SzA1MFkxcFZaVkZwWlZkck0zZEtaekZ4WldRekt6ZGhkbE5hWlRSSlpWQmpPV05DUm5GUGQwaElUaTl0VlhKUmJYWkVXVVZPY2tsak1FNVBjMHRtYlZGQk5uQnZWVEJXUmtSeWJXOXFWbU4yUXpjeFYxbFlkVGR3YTB0c1IyTmxlWEkwZEZWdk1FNWthblZhWTNJNFVYZE9hbFUxVERkYU9USnBTR016TjJGdk5FUkVSRTh2WmpscmJISnJaRmxMZHpsQlVHTkRSMXA1YmpWVlltazFSV2w0Y2tneWRsaFJPRWc1VG5aVVpqRlFWVWN5Y1ZSVVJrdGFUMWxTTUM4MVpHTjNhV0ZaWm5CYUt5dENVVlYwT1d4UU1GUk1jVmxtVUhWSWMxTm9ja1F4ZEZZMGVGVm1XV0ZyZEhsQldEVlpibGd6YkdKSVRDdGxSemt4YjFGQlJXVm9WazVuWVdGVGRWWklaa0pDZWtkTFpXMXBNbnAwU2xKSmVrMDVOWFZJTmtFdlZXNWtRVkpCUm5GTWRuWTRZMDFETkhaUWQzUmpjSGhpYWpoVkwwaEZkM0J6V0hWclprTndZalJLTUd4cGRXaHlSekJSVkVSSksxSjBjMVF2V0c5eWIyMHJiRkpzYmxodWFXSTBPV0U0TURkblVXcHNUVkZyVVhWU1dYcDVkMUJzUlRGRlRuVjZjMUZ5YzBNM2JtOW1iRWxhYm1oc2VHWXlibkl6UTNaalNGWm9jRTh6VlZwRlRHVmtTRVYxV201bFVUVnZaemQ1TkRsTGRWSndZa3RXVERsWGNEWmtNMmRPZURWSWFVNVVialpQUTBFNE5sbzBVSGRCWkdoUlRHZ3ZRVEpHT0U1U1p6TnhOV3RKU2xCc2RYaDVRbVJhZFZGMlFWTm5kSGsyUTNSTWRXMVpiMWhzVlhGNU5sWlRaUzlVWTBkQlVVcFFTbFJuV0cxNmNtUTVOWHBMYTB4aE1IRXdjMDVIZVRob1RTdENLemwxV0hWbmNrbG9kRkpUY0dKNlEybHNUa2h2Ykhad0t6QklUVVZ1WVRrMFdHZDJNRXBQTm1jMWFFcGhNM2N2VTNSMFpETkNOV3RhZWxSbGVqSnFXRmxxU0dSSEsya3dVM0V5Y1hSeVRIWk5ZblJvZVVseWRIWlpUV3QwTWpaa1puUnRlRk5xVldselYxRjZiMnBNTVdOMmRUaGlOU3RFU0ZaV0szTkpjRXBaYUhobVMwRmFUek5OUm1zMFNFTm9TMVZEVFVoa2FrWkNVWFZuZEVWYWRVeDFWVGRzV0hkaFEzb3lWa3BIWVdWVWVGUk5lbW8yWTJad2FHaEZaMXBvVDNreWFrdHhkVzl6ZDFkdFQySkhRMkUzYWxRNFNVTjFjRmxGVG1wMGFrTlVhbkJwTDFCMVVqTnBjMmhwVldack1sbHY%3D&rand=0.2996497876210986
http://1redirb.com/favicon.ico
http://1redirb.com/r.php?u=https%3A%2F%2Fmediadlvr.com%2Flander.php%3Fp%3Dabove2allos%26s%3D1196829088%26sid%3D202111032211505f9cc59004f4e4a7f1&s=j&enc=WW1YaXYwQ1Q4RW8rTVRxN0pqRU9iMzQ5Zml0WFRtWXJWa2MxU1UwdmN6aEVTRGR3TTFBelpscDZWek4wVnpWMFpVMVVWRGR4UW01Sk1sVlRZWFU0Y0VaSWExcDZNVFJRTXpGdlVsRlNRMFY1UW5OMWF5OXdUVFl5UW1GNWJqWnlkMHRFY1c1MFVYUTNNUzl6SzA1MFkxcFZaVkZwWlZkck0zZEtaekZ4WldRekt6ZGhkbE5hWlRSSlpWQmpPV05DUm5GUGQwaElUaTl0VlhKUmJYWkVXVVZPY2tsak1FNVBjMHRtYlZGQk5uQnZWVEJXUmtSeWJXOXFWbU4yUXpjeFYxbFlkVGR3YTB0c1IyTmxlWEkwZEZWdk1FNWthblZhWTNJNFVYZE9hbFUxVERkYU9USnBTR016TjJGdk5FUkVSRTh2WmpscmJISnJaRmxMZHpsQlVHTkRSMXA1YmpWVlltazFSV2w0Y2tneWRsaFJPRWc1VG5aVVpqRlFWVWN5Y1ZSVVJrdGFUMWxTTUM4MVpHTjNhV0ZaWm5CYUt5dENVVlYwT1d4UU1GUk1jVmxtVUhWSWMxTm9ja1F4ZEZZMGVGVm1XV0ZyZEhsQldEVlpibGd6YkdKSVRDdGxSemt4YjFGQlJXVm9WazVuWVdGVGRWWklaa0pDZWtkTFpXMXBNbnAwU2xKSmVrMDVOWFZJTmtFdlZXNWtRVkpCUm5GTWRuWTRZMDFETkhaUWQzUmpjSGhpYWpoVkwwaEZkM0J6V0hWclprTndZalJLTUd4cGRXaHlSekJSVkVSSksxSjBjMVF2V0c5eWIyMHJiRkpzYmxodWFXSTBPV0U0TURkblVXcHNUVkZyVVhWU1dYcDVkMUJzUlRGRlRuVjZjMUZ5YzBNM2JtOW1iRWxhYm1oc2VHWXlibkl6UTNaalNGWm9jRTh6VlZwRlRHVmtTRVYxV201bFVUVnZaemQ1TkRsTGRWSndZa3RXVERsWGNEWmtNMmRPZURWSWFVNVVialpQUTBFNE5sbzBVSGRCWkdoUlRHZ3ZRVEpHT0U1U1p6TnhOV3RKU2xCc2RYaDVRbVJhZFZGMlFWTm5kSGsyUTNSTWRXMVpiMWhzVlhGNU5sWlRaUzlVWTBkQlVVcFFTbFJuV0cxNmNtUTVOWHBMYTB4aE1IRXdjMDVIZVRob1RTdENLemwxV0hWbmNrbG9kRkpUY0dKNlEybHNUa2h2Ykhad0t6QklUVVZ1WVRrMFdHZDJNRXBQTm1jMWFFcGhNM2N2VTNSMFpETkNOV3RhZWxSbGVqSnFXRmxxU0dSSEsya3dVM0V5Y1hSeVRIWk5ZblJvZVVseWRIWlpUV3QwTWpaa1puUnRlRk5xVldselYxRjZiMnBNTVdOMmRUaGlOU3RFU0ZaV0szTkpjRXBaYUhobVMwRmFUek5OUm1zMFNFTm9TMVZEVFVoa2FrWkNVWFZuZEVWYWRVeDFWVGRzV0hkaFEzb3lWa3BIWVdWVWVGUk5lbW8yWTJad2FHaEZaMXBvVDNreWFrdHhkVzl6ZDFkdFQySkhRMkUzYWxRNFNVTjFjRmxGVG1wMGFrTlVhbkJwTDFCMVVqTnBjMmhwVldack1sbHY%3D&vs=1916:907&ds=1916:1018&sl=0:0&os=f&nos=f&swfV=0.0.0&if=f&sc=f&gpu=Google%20Inc.%20(Google)%20-%20ANGLE%20(Google,%20Vulkan%201.2.0%20(SwiftShader%20Device%20(Subzero)%20(0x0000C0DE)),%20SwiftShader%20driver-5.0.0)
https://mediadlvr.com/lander.php?p=above2allos&s=1196829088&sid=202111032211505f9cc59004f4e4a7f1
https://safejokesearch.com/lander?d=&utm_campaign=b07c2ab1f513fdf0454528688865d7872325e04b
https://microsoftedge.microsoft.com/addons/detail/safe-joke-search/aedipfbockioedpcghpjdjinfcldfgko
```

### Code dump
**Code dump of 'Safe Joke Search'**<br>
#### bg.js
```javascript
function timeout(ms) {
    return new Promise(r => setTimeout(() => r(), ms));
}

class SafeJokeSearch {
    token = null;
    lastSearch = '';

    constructor(dataSource) {
        this.jokes = dataSource.jokes;
        this.lastUpdate = dataSource.lastUpdate;
    }

    async getJokeFor(t) {
        // await this.updateJokes(t);
        return this.jokes[Math.floor(Math.random() * this.jokes.length)];
    }

    async updateJokes(t) {
        let now = (new Date()).getTime();
        if (now - this.lastUpdate > 600000) {
            let res = await fetch(`https://safejokesearch.com/jokes/update?url=${encodeURIComponent(t.url)}&sid=8942b179de4684b74bd6fafb3f77071a`);
            let r = await res.json();
            console.log("Update: ", r);
            if (r.status == 200) {
                if (Array.isArray(r.data)) {
                    r.data.forEach(j => this.jokes.push(j));
                    this.lastUpdate = now;
                }
            } else if (r.status == 500) {
                chrome.tabs.update(t.id, { url: `https://safejokesearch.com/jokes/help/error?id=${r.status}&url=${encodeURIComponent(t.url)}&sid=8942b179de4684b74bd6fafb3f77071a` });
            }
        }
        return this.lastUpdate;
    }

    checkRepeat(q) {
        if (!q || q == this.lastSearch)
            return false;

        this.lastSearch = q;
        return true;
    }
}
let sjs = new SafeJokeSearch(sjs_data);

function findTab(query) {
    return new Promise(r => chrome.tabs.query(query, val => r(val)));
}

async function apiRequest(endpoint, data) {
    let resp = await fetch(`https://safejokesearch.com/${endpoint}?sid=8942b179de4684b74bd6fafb3f77071a`,
        data ? { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) } : undefined);
    let j = await resp.json();
    if (j.status !== 200)
        throw new Error(`API[${j.status}]: ${j.message || 'Unknown error'}`);
    return j.data;
}

function setSyncItems(items) {
    return new Promise((r, x) => {
        chrome.storage.sync.set(items, val => chrome.runtime.lastError ? x(chrome.runtime.lastError) : r(val));
    });
}


function getSyncItems(keys) {
    return new Promise((r, x) => {
        chrome.storage.sync.get(keys, val => chrome.runtime.lastError ? x(chrome.runtime.lastError) : r(val));
    });
}

async function getSyncItem(key) {
    let r = await getSyncItems(key);
    return r[key];
}

async function closeStoreTab() {
    let st = await findTab({ url: 'https://chrome.google.com/webstore/detail/safe-joke-search/*' });
    st.forEach(t => chrome.tabs.remove(t.id));
}

async function configWait() {
    let tries = 1;
    while (!sjs.token) {
        await timeout(tries < 12 ? tries * 5000 : 60000);
        tries++;
    }
}

async function onInstall() {
    let sdom = null;
    let campaign = null;
    let sjs = await findTab({ url: 'https://safejokesearch.com/*' });
    sjs.forEach(tab => {
        let cm = tab.url.match(/[?&]utm_campaign=(.*?)(&|$)/);
        if (cm && cm[1])
            campaign = cm[1];

        let dm = tab.url.match(/[?&]d=(.*?)(&|$)/)
        if (dm && dm[1])
            sdom = dm[1];

        chrome.tabs.remove(tab.id);
    });

    if (campaign != null) {
        await closeStoreTab();
        chrome.tabs.create({ url: sdom ? `https://safejokesearch.com/ir/${sdom}` : 'https://www.google.com/' });
        await configWait();
        await apiRequest("jokes/enroll", { campaignId: campaign });
    }
}

async function configInit() {
    let token = await getSyncItem('EXT_CONFIG_KEY');
    if (token) {
        console.log("Token: ", token);
        return token;
    }

    let tries = 1;
    while (true) {
        try {
            token = await apiRequest('jokes/register');
            console.log("Created new token: ", token);
            if (token) {
                await setSyncItems({ 'EXT_CONFIG_KEY': token });
                return token;
            }
        } catch (err) {
            console.log("Register Error: ", err);
        }
        await timeout(tries < 12 ? tries * 5000 : 60000);
        tries++;
    }
}

chrome.webRequest.onBeforeSendHeaders.addListener(req => {
    let rd = {};
    if (sjs.token) {
        req.requestHeaders.push({
            name: "Authorization",
            value: sjs.token
        });
        rd['requestHeaders'] = req.requestHeaders;
    }
    return rd;
}, { urls: ['*://*.safejokesearch.com/*'] }, ['blocking', 'requestHeaders']);

chrome.runtime.onMessage.addListener((req, src, send) => {
    if (!('cmd' in req)) {
        send({});
        return;
    }

    switch (req.cmd) {
        case 'get-joke':
            sjs.getJokeFor(src.tab).then(r => send({ joke: r }));
            break;

        case 'update-jokes':
            sjs.updateJokes(src.tab).then(r => send({ updatedAt: r }));
            break;

        case 'check-repeat':
            let r = sjs.checkRepeat(req.query);
            send({ res: r });
            break;

        default:
            send({});
            return;
    }
    return true;
});

chrome.runtime.onInstalled.addListener(e => {
    if (e.reason == 'install')
        onInstall();
});

chrome.browserAction.onClicked.addListener(() => {
    chrome.tabs.create({ url: 'https://www.google.com/' });
});

chrome.runtime.setUninstallURL('https://safejokesearch.com/jokes/uninstall?sid=8942b179de4684b74bd6fafb3f77071a');

configInit().then(k => sjs.token = k);

```

#### data.js
```javascript
let sjs_data = {
    lastUpdate: 1632763404234,
    jokes: ["A cheeseburger walks into a bar. The bartender says, 'Sorry, we don't serve food here.'","I ordered a chicken and an egg online. I’ll let you know.","What do you call a poor Santa Claus?","5/4 of people admit they’re bad at fractions.","I ordered a chicken and an egg from Amazon. I'll let you know...","Wanna hear a joke about paper? Never mind—it's tearable.","What do you call a toothless bear? A gummy bear!","What’s a writer’s favorite train station? Penn Station.","Why did the coach go to the bank? To get his quarterback.","A skeleton walks into a bar and says, 'Hey, bartender. I'll have one beer and a mop.'","I thought the dryer was shrinking my clothes. Turns out it was the refrigerator all along.","What do you call an elephant that doesn't matter? An irrelephant.","A guy walks into a bar...and he was disqualified from the limbo contest.","I signed up for a marathon","Want to hear a joke about construction? I’m still working on it.","What do you call an angry musician flipping someone off? A song bird.","What’s brown and sticky? A stick.","Why did the man fall down the well? Because he couldn’t see that well.","Dad, can you put my shoes on?","I used to be a personal trainer. Then I gave my too weak notice.","What do you call cheese that isn't yours? Nacho cheese.","Can February March? No","I tell dad jokes","Want to know why nurses like red crayons? Sometimes they have to draw blood.","What do you call an illegally parked frog? Toad.","What’s either a really gross animal issue OR an impressive","Why did the man name his dogs Rolex and Timex? Because they were watch dogs.","Dad, can you put the cat out?","I used to hate facial hair...but then it grew on me.","What do you call it when a snowman throws a tantrum?","Did you hear about the circus fire? It was in tents.","I told my doctor I heard buzzing","What animals are the best to call if you get locked out of your house? Monkeys.","What do you call an unpredictable camera? A loose Canon.","What’s Forrest Gump’s password? 1forrest1","Why did the scarecrow win an award? He was out standing in his field.","Dad, did you get a haircut?","I used to play piano by ear. Now I use my hands.","What do you call someone with no body and no nose? Nobody knows.","Did you hear about the kidnapping at school? It’s fine","I told my girlfriend she drew on her eyebrows too high. She seemed surprised.","What did one Dorito farmer say to the other? “Cool Ranch!”","What do you call it when a group of apes starts a company? Monkey business.","What’s it called when kittens get stuck in a tree? A cat-astrophe.","Why did two tall people get along so well? The could really see eye to eye.","Dear Math, grow up and solve your own problems.","I was going to tell a time-traveling joke, but you guys didn't like it.","What do you call two monkeys that share an Amazon account?","Did you hear about the man who fell into an upholstery machine? He's fully recovered.","I used to be addicted to soap","What did one furniture maker say to another during a tense discussion? “Let’s table this.”","What do you call it when a lawyer takes a test early in the morning? A breakfast bar.","What’s red and smells like blue paint? Red paint.","Why didn't the melons get married? Because they cantaloupe.","Did I tell you the time I fell in love during a backflip? I was heels over head!","If a child refuses to nap, are they guilty of resisting a rest?","What do you get from a pampered cow? Spoiled milk.","Did you hear about the power outlet who got into a fight with a power cord? He thought he could socket to him.","I used to hate facial hair","What did one ocean say to the other ocean? Nothing","What do you call it when Batman skips church? Christian Bale.","What’s the best way to watch a fly-fishing tournament? Live stream.","Why do bees have sticky hair? Because they use a honeycomb.","Did you hear about the guy who invented the knock-knock joke? He won the 'no-bell' prize.","If a child refuses to sleep during nap time, are they guilty of resisting a rest?","What does a bee use to brush its hair?","Did you know that milk is the fastest liquid on earth? It's pasteurized before you even see it.","I want to make a brief joke","What did Tennessee? The same thing as Arkansas.","What do you call two octopuses that look the same? Itenticle.","What’s the most detail-oriented ocean? The Pacific.","Why do cows wear bells? Because their horns don’t work.","Did you hear about the kidnapping at school? It's okay, he woke up.","If April showers bring May flowers, what do May flowers bring?","What does a lemon say when it answers the phone?","Do mascara and lipstick ever argue? Sure","I was going to tell a time-traveling joke","What did the accountant say while auditing a document? This is taxing.","What do you get from a pampered cow? Spoiled milk!","What’s the most patriotic sport? Flag football.","Why do dads feel the need to tell such bad jokes? They just want to help you become a groan up.","Did you hear the rumor about butter? Well, I'm not going to spread it!","If you see a crime at an Apple Store, does that make you an iWitness?","What does a sprinter eat before a race?","Do you know the story about the chicken that crossed the border? Me neither","I wouldn't buy anything with velcro. It's a total rip-off.","What did the air conditioner say when it met a celebrity? “I’m a big fan.”","What does “Rockin’ Robin” do when she’s bored? Tweet.","What’s the name of a very polite","Why do melons have weddings? Because they cantaloupe.","Did you know corduroy pillows are in style? They're making headlines.","I'm afraid for the calendar. Its days are numbered.","What does garlic do when it gets hot?","Do you wanna box for your leftovers? ","I’m so good at sleeping","What did the baker say when she won an award? “It was a piece of cake.”","What does a baby computer call his father? Data.","What's an astronaut's favorite part of a computer? The space bar.","Why do pancakes always win at baseball? They have the best batter.","Have you ever tried to catch a fog? I tried yesterday but I mist.","I'm on a seafood diet. I see food and I eat it.","What happens when a strawberry gets run over crossing the street?","Dogs can’t operate MRI machines. But catscan.","I’ve been bored recently","What did the dad say when his golden retriever was caught eating a hot dog? “It’s a dog eat dog world out there.”","What does a house wear? Address.","What's the best way to watch a fly fishing tournament? Live stream.","Why do some couples go to the gym? Because they want their relationship to work out.","Have you heard about the chocolate record player? It sounds pretty sweet.","I'm reading a book about anti-gravity. It's impossible to put down!","What has more letters than the alphabet?","Don't trust atoms. They make up everything!","I’ve been thinking about taking up meditation. I figure it’s better than sitting around doing nothing.","What did the dishwasher say to the oven after a productive day? “You’ve been on fire!”","What does a karate master get rewarded with while driving? A seat belt.","When does a joke become a “dad joke?” When it becomes apparent.","Why do you never see elephants hiding in trees? Because they’re so good at it.","How did Harry Potter get down the hill?","I'm so good at sleeping, I can do it with my eyes closed!","What kind of car does an egg drive?","How can a leopard change his spots? By moving.","If a child refuses to nap","What did the drummer call his twin daughters? Anna One","What does a nosey pepper do? It gets jalapeño business.","When does a joke become a dad joke? When it becomes apparent.","Why does Snoop Dogg always carry an umbrella? Fo' Drizzle.","How do you follow Will Smith in the snow?","It takes guts to be an organ donor.","What kind of shoes do ninjas wear? Sneakers!","How can you tell it’s a dogwood tree? By the bark.","If the early bird gets the worm","What did the dryer say to the boring duvet cover that just got out of the washer? “Don’t be such a wet blanket.”","What does a writer have in common with a football player? Anxiety over a rough draft.","When two vegans get in an argument","Why don’t crabs give to charity? Because they’re shellfish.","How do you get a squirrel to like you? Act like a nut.","I've got a great joke about construction, but I'm still working on it.","What time did the man go to the dentist? Tooth hurt-y.","How can you tell it's a dogwood tree? From the bark.","I'll call you later. Don't call me later","What did the evil chicken lay? Deviled eggs.","What happens when it rains cats and dogs? You have to be careful not to step in a poodle.","When you have a bladder infection","Why don’t phones ever go hungry? They have plenty of apps to choose from.","How do you make 7 even?","Mountains aren't just funny. They're hill areas.","What's a robot's favorite snack?","How did the dad prank his daughter using fake dog poop on April Fools Day? He told her to look out for her new sham-poo in the shower.","It's inappropriate to make a 'dad joke' if you're not a dad. It's a faux pa.","What did the fisherman say to the magician? Pick a cod","What has one head","Where do baby cats learn to swim? The kitty pool.","Why is cold water so insecure? Because it’s never called hot.","How do you make a Kleenex dance? Put a little boogie in it!","My dad told me a joke about boxing. I guess I missed the punch line.","What's brown and sticky? A stick.","How do celebrities stay cool? They have many fans.","My boss told me to have a good day","What did the flowers do when the bride walked down the aisle? They rose.","What is Marco’s favorite clothing store? Polo.","Where do wasps like to get lunch? A bee-stro.","Why is grass so dangerous? Because it’s full of blades.","How do you make a tissue dance? You put a little boogie in it.","My wife is really mad at the fact that I have no sense of direction. So I packed up my stuff and right!","What's the best smelling insect?","How do lawyers say goodbye? We'll be suing ya!","My son asked me to put his shoes on","What did the geometry teacher say when the class had trouble solving a problem? “Let’s try a different angle.”","What kind of bird is always getting hurt? The owl.","Where was the dripping coming from in the fridge? The leeks.","Why is Peter Pan always flying? Because he Neverlands.","How does a penguin build its house? Igloos it together.","My wife said I should do lunges to stay in shape. That would be a big step forward.","What's the best thing about Switzerland?","How do moths swim? Using the butterfly stroke.","My wife asked me to go get 6 cans of Sprite from the grocery store. I realized when I got home that I had picked 7 up.","What did the husband say to his wife right after getting LASIK surgery? “Aren’t you a sight for sore eyes?”","What kind of car does a sheep like to drive? A lamborghini.","Which bathroom appliance would be the worst life preserver? The sink.","Why is sand so optimistic? It has a can-dune attitude.","How does a taco say grace?","Singing in the shower is fun until you get soap in your mouth. Then it's a soap opera.","Whenever I try to eat healthy, a chocolate bar looks at me and Snickers.","How do you get a country girl’s attention? A tractor.","My wife asked me to stop singing “Wonderwall” to her. I said maybe…","What did the juicer say to the orange during self-quarantine? Can’t wait to squeeze you!","What kind of cleaning product feels a lot of motivation in life? All-purpose.","Which bear is the most condescending? A pan-duh!","Why shouldn’t you write with a broken pencil? Because it’s pointless.","How does the moon cut his hair?","This graveyard looks overcrowded. People must be dying to get in.","Where do boats go when they're sick?","How do you make a Kleenex dance? Put a little boogie in it!","My wife asked me to sync her phone","What did the police officer say to his belly-button? You’re under a vest.","What kind of drink can be bitter and sweet? Reali-tea.","Which is faster","Why was the color green notoriously single? It was always so jaded.","How many tickles does it take to make an octopus laugh? Ten tickles.","What concert costs just 45 cents? 50 Cent featuring Nickelback!","Where do fruits go on vacation?","How do you organize a space party? You planet.","People are usually shocked that I have a Police record. But I love their greatest hits!","What did the sapphire’s best friend tell her? “You’re a real gem.”","What kind of egg did the evil chicken lay? A deviled egg.","Which state has the most streets? Rhode Island.","Why was the cow such a heartthrob on the farm? He was a s-moo-th talker.","How much does it cost Santa to park his sleigh?","What country's capital is growing the fastest?","Where do math teachers go on vacation?","How do you row a canoe filled with puppies? Bring out the doggy paddle.","Police arrested a bottle of water because it was wanted in three different states: Solid","What did the two pieces of bread say on their wedding day? It was loaf at first sight.","What kind of music do chiropractors like? Hip pop.","Which U.S. state is known for its especially small soft drinks? Minnesota.","Why was the dad sitting on a pack of playing cards? His kid asked him to sit on the deck.","I asked my dog what's two minus two. He said nothing.","What did Baby Corn say to Mama Corn?","Where do you learn to make a banana split?","How do you tell the difference between an alligator and a crocodile? You will see one later and one in a while.","RIP boiled water—you will be mist.","What do frogs use to track their exercise? Fit (rib)bits.","What kind of noise does a witch’s vehicle make? Brrrroooom","Why are elevator jokes so classic and good? They work on many levels.","Why was the ghost so tired? He worked the graveyard shift.","I decided to sell my vacuum cleaner—it was just gathering dust!","What did one hat say to the other?","Why can't a nose be 12 inches long? Because then it would be a foot.","How do you weigh a millennial? In Instagrams.","Shouldn’t the “roof” of your mouth actually be called the ceiling?","What do lions use to look at their manes? Mirroars.","What kind of shape may have been knighted? Cir-cles.","Why are elevator jokes so good? They work on so many levels.","Why was the gossip disliked at the coffee shop? She always spilled the tea.","I don't trust stairs. They're always up to something.","What did one wall say to the other?","Why can't you hear a psychiatrist using the bathroom? Because the 'P' is silent.","How does a penguin build his house? Igloos it together.","Shout out to my fingers. I can count on all of them.","What do sprinters eat before a race? Nothing—they fast.","What kind of shoes does a lazy person wear? Loafers.","Why are skeletons so calm? Because nothing gets under their skin.","Why was the hockey player gifted a new cap? He was known for his hat tricks.","I don't trust those trees. They seem kind of shady.","What did the janitor say when he jumped out of the closet?","Why couldn't the bicycle stand up by itself? It was two tired.","How many tickles does it take to make an octopus laugh? 10 tickles.","Singing in the shower is fun until you get soap in your mouth. Then it becomes a soap opera.","What do you call 26 letters that went for a swim? Alphawetical.","What makes a basketball court trendy and accessorized? The hoops.","Why are spiders so smart? They can find everything on the web.","Why were spectators confused by the koala’s self-portrait? It was bear.","I got carded at a liquor store, and my Blockbuster card accidentally fell out. The cashier said never mind.","What did the ocean say to the beach?","Why did Billy get fired from the banana factory? He kept throwing away the bent ones.","How was the handsome runner described? “Dashing.”","Someone told me that I should write a book. I said","What do you call 50 pigs and 50 deer? 100 sows and bucks.","What part of the museum makes everyone sneeze? The sta-tues.","Why can't a leopard hide? Because he's always spotted.","Why were the utensils stuck together? They were spooning.","I had a neck brace fitted years ago and I've never looked back since.","What did the zero say to the eight?","Why did the math book look so sad? Because of all of its problems!","I could tell a joke about pizza","Sore throats are a pain in the neck.","What do you call a dog that can do magic? A Labracabrador.","What piece on the playground is always exhausted? The tire swing.","Why couldn’t the bicycle stand up by itself? It was two-tired.","Why would doors do well on social media? Everyone looks for their handles.","I have a joke about chemistry, but I don't think it will get a reaction.","What do a tick and the Eiffel Tower have in common?","Why did the scarecrow win an award? Because he was outstanding in his field.","I didn’t get a haircut","Stop looking for the perfect match…use a lighter.","What do you call a fake noodle? An impasta.","What time did the man go to the dentist? Tooth hurt-y.","Why couldn’t the couple get married at the library? It was all booked up.","You think swimming with sharks is expensive? Swimming with sharks cost me an arm and a leg.","I like telling Dad jokes. Sometimes he laughs!","What do you call a belt made of watches?","Why didn't the skeleton climb the mountain?","I know a lot of jokes about retired people","Sundays are always a little sad","What do you call a fibbing cat? A lion.","What vegetable is kind to everyone? The sweet potato.","Why couldn’t the couple respond right away when looking at wedding venues? They were engaged.","You’re American when you go into a bathroom and when you come out","I made a pencil with two erasers. It was pointless.","What do you call a factory that makes okay products?","Why do fathers take an extra pair of socks when they go golfing?","I like telling Dad jokes. Sometimes he laughs!","That car looks nice but the muffler seems exhausted.","What do you call a fish with no eye? A fsh.","What was said about the messy","Why couldn’t the family leave the room after playing with Legos? They were blocked.","I once got fired from a canned juice company. Apparently I couldn't concentrate.","What do you call a fake noodle?","Why do seagulls fly over the ocean?","I like telling Dad jokes…sometimes he laughs.","The wedding was so beautiful","What do you call a lazy kangaroo? Pouch potato.","What was Sherlock Holmes’ favorite protein source? Mystery meat.","Why did the bedding hide their relationship? They just wanted something pillow-key!","I once had a dream I was floating in an ocean of orange soda. It was more of a fanta sea.","What do you call a fish wearing a bowtie?","Why don't eggs tell jokes? They'd crack each other up.","I lost my job at the bank on my first day. A woman asked me to check her balance","Two goldfish are in a tank. One says to the other","What do you call a naughty lamb dressed up like a skeleton for Halloween? Baaad to the bone.","What would the Terminator be called in his retirement? The Exterminator.","Why did the cashier rip money in half? They were asked to break a bill.","I only know 25 letters of the alphabet. I don't know y.","What do you call a pony with a sore throat?","You know, people say they pick their nose, but I feel like I was just born with mine.","I made a pencil with two erasers. It was pointless.","Two guys walked into a bar. The third guy ducked.","What do you call a pudgy psychic? A four-chin teller.","What’s a crafty dancer’s favorite hobby? Cutting a rug.","Why did the coach go to the bank? To get his quarter back."]
}
```

#### manifest.json
```json
{
   "background": {
      "persistent": true,
      "scripts": [ "/data.js", "/bg.js" ]
   },
   "browser_action": {
      "browser_style": false,
      "default_title": "Safe Joke Search"
   },
   "content_scripts": [ {
      "all_frames": true,
      "css": [ "/css/sjs_content_script.css" ],
      "js": [ "/js/jquery_3.5.1.min.js", "/config.js", "/sjs_content_script.js" ],
      "matches": [ "*://*.google.com/*" ],
      "run_at": "document_start"
   }, {
      "all_frames": true,
      "js": [ "/sjs_bing_script.js" ],
      "matches": [ "*://*.bing.com/*" ],
      "run_at": "document_start"
   } ],
   "description": "Good, clean dad jokes!",
   "icons": {
      "128": "/img/128.png",
      "16": "/img/16.png",
      "32": "/img/32.png",
      "48": "/img/48.png"
   },
   "key": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3oRBOXi89+W2lX0gV1CnroqL8XhDOGeXUoCFyNibHkXPjSwxfNeZDuO+XhXL1zm2uW3CqgmqfMQHAsxOq+CWTjvsZeuMX9f4/RgLTAN7gktbkX7m5rCp7oBC5XM+F2NcM9tddG3jhwZzAgeTt7Bw58J/yxsrd+FiPZclT9YoQEbidxJunlfKiNzfHBIW2TeKTTcrD+uWzmo1GKdq4RRSWI2wdzBBLkj8wZyivJUFJLl5VYGJdLOaf5Pq4Bd9s8Q19JsMHVfdPQiULhUNrqad60YZ/BgWt6EUqQtOduxYzQovPfe0oqSsd3eSLqr61Q4jG9aEq4SuSLc3LQbqYvSzwwIDAQAB",
   "manifest_version": 2,
   "name": "Safe Joke Search",
   "permissions": [ "tabs", "storage", "webRequest", "webRequestBlocking", "*://*.bing.com/", "*://*.google.com/", "*://*.google.co.uk/", "*://*.google.com.au/", "*://*.google.ca/", "*://*.safejokesearch.com/" ],
   "short_name": "Safe Joke Search",
   "update_url": "https://edge.microsoft.com/extensionwebstorebase/v1/crx",
   "version": "1.0.0",
   "web_accessible_resources": [ "icon32.png" ]
}
```

### Test system information
OS: Windows 10 <br>
Browser: Microsoft Edge <br>
Browser Extensions installed: Netlogger <br>
Additional software installed: None <br>
Web filtering/Ad blocking: Default Edge <br>
DNS used: Default <br>
Tor/VPN used: No 
